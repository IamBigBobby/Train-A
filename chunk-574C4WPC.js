import{a as A}from"./chunk-6RWEUSYO.js";import{a as _}from"./chunk-7UUFDETP.js";import{F as $,H as q,I as z,J as w}from"./chunk-7DOSCQIA.js";import"./chunk-ZV7KZKEA.js";import"./chunk-2FEQR2WY.js";import"./chunk-ZGX5YXHD.js";import{gb as S,k as g,m as P,n as V,r as B,s as L,u as k,v as G,x as y}from"./chunk-V43RW7AC.js";import{m as F}from"./chunk-H4NAPNW2.js";import{Ab as a,Ba as u,Bb as n,Cb as l,Gb as T,Ja as Q,Jb as p,Jc as Z,Ka as b,Kb as c,La as D,Mc as ee,Sa as O,Tb as s,Vb as I,Zb as W,bb as m,bc as f,gc as X,hc as Y,qb as M,sb as C,ua as d,vb as N,xb as E,yb as h,zb as x}from"./chunk-FW5WJFJQ.js";import{a as K}from"./chunk-T527G4PA.js";function re(r,t){if(r&1&&(a(0,"div",5),s(1),n()),r&2){let e=t.$implicit,i=c().$index,o=c();m(),I("L-",e+(o.leftSeats.length+o.rightSeats.length)*i,"")}}function ie(r,t){if(r&1&&(a(0,"div",5),s(1),n()),r&2){let e=t.$implicit,i=c().$index,o=c();m(),I(" R-",o.getSeats(o.carriagesData.leftSeats).length+e+(o.leftSeats.length+o.rightSeats.length)*i," ")}}function ae(r,t){if(r&1&&(a(0,"div",3)(1,"div",4),h(2,re,2,1,"div",5,E),n(),a(4,"div",6),h(5,ie,2,1,"div",5,E),n()()),r&2){let e=c();m(2),x(e.leftSeats),m(3),x(e.rightSeats)}}var v=class r{carriagesData;rows=[];leftSeats=[];rightSeats=[];ngOnChanges(t){t.carriagesData&&this.carriagesData&&(this.rows=this.getRows(this.carriagesData.rows),this.leftSeats=this.getSeats(this.carriagesData.leftSeats),this.rightSeats=this.getSeats(this.carriagesData.rightSeats))}getRows(t){return Array.from({length:t},(i,o)=>o+1)}getSeats(t){return Array.from({length:t},(i,o)=>o+1)}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=u({type:r,selectors:[["app-carriage"]],inputs:{carriagesData:"carriagesData"},standalone:!0,features:[Q,f],decls:9,vars:2,consts:[[1,"carriage"],[1,"carriage__header"],[1,"carriage__body"],[1,"carriage__row"],[1,"carriage__left-seats"],[1,"carriage__seat"],[1,"carriage__right-seats"]],template:function(e,i){e&1&&(a(0,"div",0)(1,"div",1)(2,"span"),s(3),n(),a(4,"span"),s(5),n()(),a(6,"div",2),h(7,ae,7,0,"div",3,E),n()()),e&2&&(m(3),I("Name: ",i.carriagesData.name,""),m(2),I("Sits: ",(i.leftSeats.length+i.rightSeats.length)*i.rows.length,""),m(2),x(i.rows))},styles:[".carriage[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px;align-items:center;width:auto;margin:10px;padding:10px;border:1px solid gray;border-radius:5px}.carriage__header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;width:100%}.carriage__header[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:700}.carriage__body[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:20px}.carriage__row[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:50px;align-items:center}.carriage__right-seats[_ngcontent-%COMP%], .carriage__left-seats[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:5px}.carriage__seat[_ngcontent-%COMP%]{display:flex;flex:1 1 10px;align-items:center;justify-content:center;min-width:10px;min-height:10px;padding:5px 10px;font-size:10px;text-align:center;background-color:#e0e0e0;border-radius:3px}@media (width <= 1300px){.carriage__body[_ngcontent-%COMP%]{gap:5px}}@media (width <= 1300px){.carriage__row[_ngcontent-%COMP%]{gap:25px}}@media (width <= 1300px){.carriage__seat[_ngcontent-%COMP%]{flex:1 1 5px;min-width:5px;min-height:5px;padding:2.5px 5px;font-size:10px}}"]})};var U=class r{carriagesData;formClosed=new O;formBuilder=d(G);store=d(F);initialFormValues;editCarriagesForm=this.formBuilder.group({name:["",g.required],rows:["",g.required],leftSeats:["",g.required],rightSeats:["",g.required]});ngOnInit(){this.carriagesData&&(this.editCarriagesForm.patchValue(this.carriagesData),this.initialFormValues=K({},this.carriagesData),this.editCarriagesForm.valueChanges.subscribe(t=>{this.carriagesData?.code&&this.store.dispatch(_.updCarriageType({code:this.carriagesData.code,updatedCarriage:t}))}))}updStation(){if(this.editCarriagesForm.invalid){alert("Please fill in all fields before updating.");return}let t={code:this.editCarriagesForm.get("name")?.value,name:this.editCarriagesForm.get("name")?.value,rows:this.editCarriagesForm.get("rows")?.value,leftSeats:this.editCarriagesForm.get("leftSeats")?.value,rightSeats:this.editCarriagesForm.get("rightSeats")?.value};this.carriagesData.code&&(this.store.dispatch(_.updCarriageTypeSuccsess({code:this.carriagesData.code,updatedCarriage:t})),this.formClosed.emit())}resetForm(){this.initialFormValues&&this.editCarriagesForm.patchValue(this.initialFormValues)}closeForm(){this.resetForm(),this.formClosed.emit()}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=u({type:r,selectors:[["app-carriages-dynamic-form"]],inputs:{carriagesData:"carriagesData"},outputs:{formClosed:"formClosed"},standalone:!0,features:[f],decls:17,vars:1,consts:[[1,"carriages__upd-form",3,"ngSubmit","formGroup"],["placeholder","enter new name","formControlName","name"],["tuiTextfieldLegacy","","placeholder","enter new name","type","text"],["formControlName","rows"],["tuiTextfieldLegacy","","placeholder","enter new rows","type","number"],["formControlName","leftSeats"],["tuiTextfieldLegacy","","placeholder","enter new left seats","type","number"],["formControlName","rightSeats"],["tuiTextfieldLegacy","","placeholder","enter new right seats","type","number"],["size","s","tuiButton",""],["size","s","tuiButton","",3,"click"]],template:function(e,i){e&1&&(a(0,"form",0),p("ngSubmit",function(){return i.updStation()}),a(1,"tui-input",1),s(2," name "),l(3,"input",2),n(),a(4,"tui-input",3),s(5," rows "),l(6,"input",4),n(),a(7,"tui-input",5),s(8," left seats "),l(9,"input",6),n(),a(10,"tui-input",7),s(11," right seats "),l(12,"input",8),n(),a(13,"button",9),s(14,"Update carriage"),n()(),a(15,"button",10),p("click",function(){return i.closeForm()}),s(16,"Close update form"),n()),e&2&&C("formGroup",i.editCarriagesForm)},dependencies:[S,y,B,P,V,L,k,w,q,z,$],styles:[".carriages__upd-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:5px;justify-content:center;width:30vw}button[_ngcontent-%COMP%]{width:30vw;margin-top:5px}"]})};var j=class r{formClosed=new O;formBuilder=d(G);store=d(F);createCarriagesForm=this.formBuilder.group({name:["",g.required],rows:["",g.required],leftSeats:["",g.required],rightSeats:["",g.required]});carriagesList=[];get carriagesData(){return{code:this.createCarriagesForm.get("name")?.value,name:this.createCarriagesForm.get("name")?.value,rows:this.createCarriagesForm.get("rows")?.value,leftSeats:this.createCarriagesForm.get("leftSeats")?.value,rightSeats:this.createCarriagesForm.get("rightSeats")?.value}}ngOnInit(){this.store.select(A).subscribe(t=>{this.carriagesList=t})}createStation(){if(this.createCarriagesForm.invalid){alert("Please fill in all fields before updating.");return}let t=this.carriagesData;if(this.carriagesList.some(i=>i.name===t.name)){alert("Carriage with this name already exists.");return}this.store.dispatch(_.createNewCarriageType({newCarriages:t})),this.closeForm()}closeForm(){this.formClosed.emit()}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=u({type:r,selectors:[["app-carriages-dynamic-from-create"]],outputs:{formClosed:"formClosed"},standalone:!0,features:[f],decls:17,vars:2,consts:[[3,"carriagesData"],[1,"carriages__edit-form",3,"ngSubmit","formGroup"],["placeholder","enter new name","formControlName","name"],["tuiTextfieldLegacy","","placeholder","enter new name","type","text"],["formControlName","rows"],["tuiTextfieldLegacy","","placeholder","enter new rows","type","number"],["formControlName","leftSeats"],["tuiTextfieldLegacy","","placeholder","enter new left seats","type","number"],["formControlName","rightSeats"],["tuiTextfieldLegacy","","placeholder","enter new right seats","type","number"],["size","s","tuiButton",""]],template:function(e,i){e&1&&(a(0,"div"),l(1,"app-carriage",0),a(2,"form",1),p("ngSubmit",function(){return i.createStation()}),a(3,"tui-input",2),s(4," name "),l(5,"input",3),n(),a(6,"tui-input",4),s(7," rows "),l(8,"input",5),n(),a(9,"tui-input",6),s(10," left seats "),l(11,"input",7),n(),a(12,"tui-input",8),s(13," right seats "),l(14,"input",9),n(),a(15,"button",10),s(16,"Create carriage"),n()()()),e&2&&(m(),C("carriagesData",i.carriagesData),m(),C("formGroup",i.createCarriagesForm))},dependencies:[S,y,B,P,V,L,k,w,q,z,$,v],styles:[".carriages__edit-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:5px;justify-content:center;width:30vw}button[_ngcontent-%COMP%]{width:30vw}"]})};var me=(r,t)=>t.code;function le(r,t){if(r&1){let e=T();a(0,"h2"),s(1,"New carriage"),n(),a(2,"app-carriages-dynamic-from-create",1),p("formClosed",function(){b(e);let o=c();return D(o.closeCreateField())}),n()}}function ce(r,t){r&1&&s(0," Close create carriage ")}function pe(r,t){r&1&&s(0," Create carriage ")}function ge(r,t){if(r&1){let e=T();a(0,"app-carriages-dynamic-form",4),p("formClosed",function(){b(e);let o=c(2);return D(o.clearCurrentCarriage())}),n()}if(r&2){let e=c().$implicit;C("carriagesData",e)}}function de(r,t){if(r&1){let e=T();a(0,"button",5),p("click",function(){b(e);let o=c().$implicit,J=c();return D(J.toggleUpdForm(o))}),s(1,"Update carriage"),n()}}function ue(r,t){if(r&1&&(l(0,"app-carriage",2),M(1,ge,1,1,"app-carriages-dynamic-form",2)(2,de,2,0,"button",3)),r&2){let e=t.$implicit,i=c();C("carriagesData",e),m(),N(i.currentCarriageToUpdate===e.code?1:2)}}var te=class r{store=d(F);carriagesList$=this.store.select(A);isCreateFieldOpen=!1;currentCarriageToUpdate;constructor(){this.store.dispatch(_.loadCarriagesList())}toggleCreateField(){this.isCreateFieldOpen=!this.isCreateFieldOpen}toggleUpdForm(t){this.currentCarriageToUpdate=t.code}clearCurrentCarriage(){this.currentCarriageToUpdate=void 0}closeCreateField(){this.isCreateFieldOpen=!1}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=u({type:r,selectors:[["app-carriages"]],standalone:!0,features:[f],decls:10,vars:4,consts:[["size","l","tuiButton","",3,"click"],[3,"formClosed"],[3,"carriagesData"],["size","s","tuiButton",""],[3,"formClosed","carriagesData"],["size","s","tuiButton","",3,"click"]],template:function(e,i){if(e&1){let o=T();M(0,le,3,0),a(1,"button",0),p("click",function(){return b(o),D(i.toggleCreateField())}),M(2,ce,1,0)(3,pe,1,0),n(),a(4,"h2"),s(5,"Carriages"),n(),W(6),X(7,"async"),h(8,ue,3,2,null,null,me)}if(e&2){N(i.isCreateFieldOpen?0:-1),m(2),N(i.isCreateFieldOpen?2:3);let o=Y(7,2,i.carriagesList$);m(6),x(o)}},dependencies:[S,ee,Z,y,w,U,j,v],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;gap:10px;max-width:calc(100vw - 40px)}button[_ngcontent-%COMP%]{width:30vw;margin-top:5px}"]})};export{te as CarriagesComponent};
